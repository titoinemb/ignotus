{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///media/a/Dev/ignotus/app/src/app/hooks/useSubTitle.ts"],"sourcesContent":["'use client';\nimport { useEffect, useState } from 'react';\nimport { parseSrt } from \"../functions\";\nimport { SubtitlesState } from \"@types\";\n\nexport const useSubtitles = (srt: string | null | undefined, srtUrl: string | null | undefined, videoId: string, offset: number) => {\n  const [state, setState] = useState<SubtitlesState>({\n    cues: [],\n    activeText: null,\n    loading: true,\n    error: false,\n  });\n\n  const shouldShowOverlay = srt !== null && srtUrl !== null;\n\n  useEffect(() => {\n    let cancelled = false;\n\n    const loadCues = async () => {\n      if (!shouldShowOverlay) {\n        return setState({ cues: [], activeText: null, loading: false, error: false });\n      };\n\n      if (srt) {\n        return setState({ ...state, cues: parseSrt(srt), loading: false });\n      };\n\n      if (srtUrl) {\n        try {\n          let res = await fetch(srtUrl);\n\n          if (!res.ok) return setState({ ...state, cues: [], loading: false, error: true });\n            \n          let txt = await res.text();\n\n          if (!cancelled) return setState({ ...state, cues: parseSrt(txt), loading: false });\n        } catch (error) {\n          if (!cancelled) return setState({ ...state, cues: [], loading: false, error: true });\n        };\n      };\n    };\n\n    loadCues();\n    return () => { cancelled = true; };\n  }, [srt, srtUrl, shouldShowOverlay, state]);\n\n  useEffect(() => {\n    const video = document.getElementById(videoId) as HTMLVideoElement | null;\n    if (!video) {\n      console.warn('Video element not found:', videoId);\n      return;\n    };\n\n    if (!shouldShowOverlay || state.cues.length === 0) return setState(prevState => ({ ...prevState, activeText: null }));\n\n    let raf = 0;\n    const updateActiveText = () => {\n      const currentTime = (video.currentTime || 0) + offset;\n      const cue = state.cues.find(c => currentTime >= c.start && currentTime <= c.end);\n      setState(prevState => ({ ...prevState, activeText: cue ? cue.text : null }));\n      raf = requestAnimationFrame(updateActiveText);\n    };\n\n    raf = requestAnimationFrame(updateActiveText);\n    return () => cancelAnimationFrame(raf);\n  }, [videoId, state.cues, offset, shouldShowOverlay]);\n\n  return { activeText: state.activeText };\n};"],"names":[],"mappings":";;;;AACA;AACA;AAAA;AAFA;;;AAKO,MAAM,eAAe,CAAC,KAAgC,QAAmC,SAAiB;IAC/G,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAiB;QACjD,MAAM,EAAE;QACR,YAAY;QACZ,SAAS;QACT,OAAO;IACT;IAEA,MAAM,oBAAoB,QAAQ,QAAQ,WAAW;IAErD,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY;QAEhB,MAAM,WAAW;YACf,IAAI,CAAC,mBAAmB;gBACtB,OAAO,SAAS;oBAAE,MAAM,EAAE;oBAAE,YAAY;oBAAM,SAAS;oBAAO,OAAO;gBAAM;YAC7E;;YAEA,IAAI,KAAK;gBACP,OAAO,SAAS;oBAAE,GAAG,KAAK;oBAAE,MAAM,IAAA,+IAAQ,EAAC;oBAAM,SAAS;gBAAM;YAClE;;YAEA,IAAI,QAAQ;gBACV,IAAI;oBACF,IAAI,MAAM,MAAM,MAAM;oBAEtB,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,SAAS;wBAAE,GAAG,KAAK;wBAAE,MAAM,EAAE;wBAAE,SAAS;wBAAO,OAAO;oBAAK;oBAE/E,IAAI,MAAM,MAAM,IAAI,IAAI;oBAExB,IAAI,CAAC,WAAW,OAAO,SAAS;wBAAE,GAAG,KAAK;wBAAE,MAAM,IAAA,+IAAQ,EAAC;wBAAM,SAAS;oBAAM;gBAClF,EAAE,OAAO,OAAO;oBACd,IAAI,CAAC,WAAW,OAAO,SAAS;wBAAE,GAAG,KAAK;wBAAE,MAAM,EAAE;wBAAE,SAAS;wBAAO,OAAO;oBAAK;gBACpF;;YACF;;QACF;QAEA;QACA,OAAO;YAAQ,YAAY;QAAM;IACnC,GAAG;QAAC;QAAK;QAAQ;QAAmB;KAAM;IAE1C,IAAA,kNAAS,EAAC;QACR,MAAM,QAAQ,SAAS,cAAc,CAAC;QACtC,IAAI,CAAC,OAAO;YACV,QAAQ,IAAI,CAAC,4BAA4B;YACzC;QACF;;QAEA,IAAI,CAAC,qBAAqB,MAAM,IAAI,CAAC,MAAM,KAAK,GAAG,OAAO,SAAS,CAAA,YAAa,CAAC;gBAAE,GAAG,SAAS;gBAAE,YAAY;YAAK,CAAC;QAEnH,IAAI,MAAM;QACV,MAAM,mBAAmB;YACvB,MAAM,cAAc,CAAC,MAAM,WAAW,IAAI,CAAC,IAAI;YAC/C,MAAM,MAAM,MAAM,IAAI,CAAC,IAAI,CAAC,CAAA,IAAK,eAAe,EAAE,KAAK,IAAI,eAAe,EAAE,GAAG;YAC/E,SAAS,CAAA,YAAa,CAAC;oBAAE,GAAG,SAAS;oBAAE,YAAY,MAAM,IAAI,IAAI,GAAG;gBAAK,CAAC;YAC1E,MAAM,sBAAsB;QAC9B;QAEA,MAAM,sBAAsB;QAC5B,OAAO,IAAM,qBAAqB;IACpC,GAAG;QAAC;QAAS,MAAM,IAAI;QAAE;QAAQ;KAAkB;IAEnD,OAAO;QAAE,YAAY,MAAM,UAAU;IAAC;AACxC"}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///media/a/Dev/ignotus/app/src/app/components/layout/SubTitle.tsx"],"sourcesContent":["import React from 'react';\r\nimport { SubTitleProps } from \"@types\";\r\nimport { sanitizeSubtitleHtml } from \"../../functions\";\r\nimport { useSubtitles } from \"../../hooks/useSubTitle\";\r\nimport \"../../styles/subTitle.scss\";\r\n\r\nexport const SubTitle: React.FC<SubTitleProps> = ({videoId, srt, srtUrl, offset = 0, className}) => {\r\n  const { activeText } = useSubtitles(srt, srtUrl, videoId, offset);\r\n\r\n  return (\r\n    <div\r\n      aria-live=\"polite\"\r\n      className={className}\r\n      style={{\r\n        position: 'absolute',\r\n        left: 0,\r\n        right: 0,\r\n        bottom: '6%',\r\n        pointerEvents: 'none',\r\n        textAlign: 'center',\r\n        padding: '0 1rem',\r\n      }}\r\n    >\r\n      {activeText && (\r\n        <div\r\n          style={{\r\n            display: 'inline-block',\r\n            background: 'rgba(0,0,0,0.7)',\r\n            color: '#fff',\r\n            padding: '6px 10px',\r\n            borderRadius: 6,\r\n            whiteSpace: 'pre-wrap',\r\n            lineHeight: 1.2,\r\n            fontSize: 16,\r\n          }}\r\n          dangerouslySetInnerHTML={{ __html: sanitizeSubtitleHtml(activeText) }}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;;;;;AAGO,MAAM,WAAoC,CAAC,EAAC,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,SAAS,CAAC,EAAE,SAAS,EAAC;IAC7F,MAAM,EAAE,UAAU,EAAE,GAAG,IAAA,kJAAY,EAAC,KAAK,QAAQ,SAAS;IAE1D,qBACE,8OAAC;QACC,aAAU;QACV,WAAW;QACX,OAAO;YACL,UAAU;YACV,MAAM;YACN,OAAO;YACP,QAAQ;YACR,eAAe;YACf,WAAW;YACX,SAAS;QACX;kBAEC,4BACC,8OAAC;YACC,OAAO;gBACL,SAAS;gBACT,YAAY;gBACZ,OAAO;gBACP,SAAS;gBACT,cAAc;gBACd,YAAY;gBACZ,YAAY;gBACZ,UAAU;YACZ;YACA,yBAAyB;gBAAE,QAAQ,IAAA,uKAAoB,EAAC;YAAY;;;;;;;;;;;AAK9E"}}]
}